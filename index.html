<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xlwenic</title>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RRVD3RER91"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){ dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-RRVD3RER91'); // Your GA4 Measurement ID
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            width: 100%;
            height: 90vh;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
            display: flex;
            flex-direction: column;
        }
        .header {
            background-color: #1e1e1e;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 18px;
            height: 50px;
            flex-shrink: 0;
        }
        .menu-btn {
            font-size: 20px;
            cursor: pointer;
        }
        .chat-container {
            flex: 1;
            padding: 10px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            min-height: 0; /* Ensures proper scrolling */
        }
        .message {
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 8px;
            max-width: 55%;
            font-size: 14px;
            line-height: 1.2;
            opacity: 0;
            animation: fadeIn 0.3s ease-in forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .typing {
            font-style: italic;
            opacity: 0.6;
        }
        .user {
            background-color: #0b93f6;
            align-self: flex-end;
            text-align: right;
            color: white;
        }
        .bot {
            background-color: #3a3a3a;
            align-self: flex-start;
            text-align: left;
            color: white;
        }
        .input-container {
            display: flex;
            padding: 5px;
            background-color: #1e1e1e;
            height: 40px;
            flex-shrink: 0;
        }
        input {
            flex: 1;
            padding: 5px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            height: 30px;
        }
        button {
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            height: 30px;
        }
        .footer {
            text-align: center;
            padding: 5px;
            background-color: #1e1e1e;
            color: white;
            font-size: 12px;
            height: 30px;
            flex-shrink: 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <span>Xlwenic</span>
        <span class="menu-btn" onclick="location.href='https://xlwenic.lua.ren/about.html'">☰</span>
    </div>

    <div class="chat-container" id="chat-container"></div>

    <div class="input-container">
        <input type="text" id="user-input" placeholder="Type a message..." />
        <button onclick="sendMessage()">Send</button>
    </div>

    <div class="footer">Made By Xnic Corp | Powered By Xlwenic</div>

    <script>
        async function sendMessage() {
            let inputField = document.getElementById("user-input");
            let message = inputField.value.trim();
            if (message === "") return;

            addMessage(message, "user");
            inputField.value = "";

            gtag('event', 'user_message', { 'message': message });

            // Show typing indicator
            let typingIndicator = document.createElement("div");
            typingIndicator.textContent = "Xlwenic is typing...";
            typingIndicator.classList.add("message", "bot", "typing");
            document.getElementById("chat-container").appendChild(typingIndicator);
            scrollToBottom();

            let response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Authorization": "Bearer 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",
                    "HTTP-Referer": "https://xlwenic.lua.ren",
                    "X-Title": "Xlwenic AI Chat",
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    "model": "google/gemini-2.0-flash-lite-preview-02-05:free",
                    "messages": [{ "role": "user", "content": message }]
                })
            });

            let data = await response.json();
            let botReply = data.choices?.[0]?.message?.content || "Error: No response from AI.";

            if (botReply.includes("I am a large language model, trained by Google.")) {
                botReply = "It’s Xlwenic and Made By Xnic Corp. Xnic Corp using Google Dataset for Xlwenic. Current Dataset Trained By Google. The Only One Founder of Xnic Corp is Al Baradi Joy. In Future Xnic Corp will Come with his Own Dataset after Complete their Training and Experiment.";
            }

            setTimeout(() => {
                typingIndicator.remove();
                typeMessage(botReply, "bot");
            }, 1000);

            gtag('event', 'bot_response', { 'response': botReply });
        }

        function addMessage(text, sender) {
            let chatContainer = document.getElementById("chat-container");
            let messageDiv = document.createElement("div");
            messageDiv.textContent = text;
            messageDiv.classList.add("message", sender);
            chatContainer.appendChild(messageDiv);
            scrollToBottom();
        }

        function typeMessage(text, sender) {
            let chatContainer = document.getElementById("chat-container");
            let messageDiv = document.createElement("div");
            messageDiv.classList.add("message", sender);
            chatContainer.appendChild(messageDiv);
            scrollToBottom();

            let index = 0;
            function typeLetter() {
                if (index < text.length) {
                    messageDiv.textContent += text[index];
                    index++;
                    setTimeout(typeLetter, 20);
                }
            }
            typeLetter();
        }

        function scrollToBottom() {
            let chatContainer = document.getElementById("chat-container");
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }
    </script>
</body>
</html>
